# 低波债券轮动策略说明

## 策略概述

低波债券轮动策略是一种基于**低波动率异象**和**动量轮动**的量化投资策略，适用于债券ETF、债券基金等低风险固收类资产。

### 核心理念

- **低波动率异象**：研究表明，低波动率资产的长期风险调整后收益往往优于高波动率资产
- **动量效应**：具有正向动量的资产倾向于继续保持良好表现
- **轮动机制**：定期调整持仓，持有表现最优的资产组合

## 策略逻辑

### 1. 筛选流程

```
候选池 
  ↓
计算60日年化波动率
  ↓
筛选波动率最低的30%
  ↓
过滤20日收益率>0的标的
  ↓
按收益风险比排序
  ↓
选择Top N（默认10只）
```

### 2. 核心指标

| 指标 | 计算方式 | 作用 |
|------|---------|------|
| 年化波动率 | std(60日收益率) × √252 | 衡量风险，选择低波标的 |
| 动量得分 | 20日累计收益率 | 筛选正向趋势标的 |
| 夏普比率 | 年化收益 / 年化波动率 | 衡量风险调整后收益 |
| 最大回撤 | (峰值-谷值) / 峰值 | 评估下行风险 |
| 综合得分 | 动量 / 波动率 | 排序依据 |

### 3. 推荐规则

- **波动率筛选**：选择波动率最低的30%标的（可配置）
- **动量过滤**：剔除近20日收益为负的标的
- **流动性要求**：日均成交额 > 1000万元
- **持仓数量**：推荐Top 10（可配置）
- **仓位分配**：等权分配或限制单只不超过15%

### 4. 风控机制

- **止损线**：单只持仓亏损超过3%触发剔除
- **分散化**：持有5-10只标的，避免过度集中
- **流动性要求**：确保可以及时调仓

## 使用方法

### 1. 基本使用

```python
from src.analysis import LowVolatilityRotation
from src.data_source import DataFetcher

# 加载配置
config = {
    'volatility_window': 60,    # 波动率计算窗口
    'momentum_window': 20,      # 动量计算窗口
    'low_vol_percentile': 30,   # 低波百分位
    'top_n': 10,                # 推荐数量
    'min_liquidity': 10000000,  # 最小日均成交额
    'max_position_pct': 15,     # 单只最大持仓
    'stop_loss_pct': 3,         # 止损比例
    'min_momentum': 0,          # 最小动量
}

# 初始化策略
strategy = LowVolatilityRotation(config)

# 准备候选标的数据
candidates = [
    {
        'code': '511010.SH',
        'name': '国债ETF',
        'price_data': price_df  # 包含 date, close, volume, amount 列
    },
    # ... 更多候选标的
]

# 分析
analyzed_data = strategy.analyze(candidates)

# 生成推荐
recommendations = strategy.generate_recommendations(analyzed_data)

# 查看推荐结果
for rec in recommendations:
    print(f"{rec['rank']}. {rec['name']}: 得分={rec['score']:.2f}")
```

### 2. 配置说明

在 `config/config.yaml` 中配置策略参数：

```yaml
analysis:
  strategies:
    low_volatility_rotation:
      enabled: true
      volatility_window: 60     # 波动率计算窗口（交易日）
      momentum_window: 20       # 动量计算窗口（交易日）
      low_vol_percentile: 30    # 低波百分位（%）
      top_n: 10                 # 推荐数量
      min_liquidity: 10000000   # 最小日均成交额（元）
      max_position_pct: 15      # 单只最大持仓比例（%）
      stop_loss_pct: 3          # 止损比例（%）
      min_momentum: 0           # 最小动量要求（%）
```

### 3. 数据要求

候选标的的价格数据需包含以下列：

- `date`: 日期
- `close`: 收盘价
- `volume`: 成交量
- `amount`: 成交额

建议数据长度：至少80个交易日（满足60日波动率计算需求）

## 适用标的

### 推荐标的类型

1. **债券ETF**（最佳）
   - 国债ETF（如511010）
   - 地方债ETF
   - 信用债ETF
   - 中短债ETF

2. **债券基金**
   - 纯债基金
   - 短债基金
   - 中短债基金

3. **可转债基金**（进阶）
   - 可转债ETF
   - 可转债基金

### 数据源选择

- **AkShare**: 获取国内债券ETF和基金数据
- **YFinance**: 获取上市债券ETF数据（推荐）
- **Twelve Data**: 获取全球债券ETF数据

示例代码：

```python
from src.data_source import DataFetcher

# 使用YFinance获取债券ETF数据
config = {
    'provider': 'yfinance',
    'cache': {'enabled': True}
}

fetcher = DataFetcher(config)

# 获取国债ETF历史数据
data = fetcher.fetch_stock_data(
    '511010.SH',           # 国债ETF
    '2023-01-01',          # 开始日期
    '2024-12-31'           # 结束日期
)
```

## 回测表现

### 预期指标（基于历史回测）

| 指标 | 目标值 |
|------|--------|
| 年化收益率 | 5-8% |
| 最大回撤 | < 5% |
| 夏普比率 | > 1.5 |
| 月度胜率 | 65-75% |
| 卡玛比率 | > 2.0 |

### 适用市场环境

- ✅ **震荡市**：低波策略在震荡市表现最佳
- ✅ **弱牛市**：稳健获取收益
- ⚠️ **单边牛市**：收益可能低于激进策略
- ⚠️ **暴跌市**：需及时止损

## 调仓建议

### 调仓频率

- **推荐**：月度调仓（每月第一个交易日）
- **可选**：季度调仓（降低交易成本）
- **不推荐**：周度或日度调仓（债券波动低，高频无意义）

### 调仓流程

1. 每月第一个交易日运行策略
2. 获取最新推荐列表
3. 对比当前持仓：
   - 已持有且仍在推荐列表：保持
   - 已持有但不在推荐列表：卖出
   - 未持有但在推荐列表：买入
4. 调整仓位至目标配置

### 交易成本控制

- 换手率控制在30-50%
- 避免频繁交易同一标的
- 考虑交易成本后的净收益

## 风险提示

1. **市场风险**：债券市场也会波动，可能出现亏损
2. **流动性风险**：部分债券基金赎回可能有限制
3. **信用风险**：信用债存在违约风险
4. **利率风险**：利率上升时债券价格下跌
5. **策略失效风险**：历史表现不代表未来

## 优化方向

### 已实现功能

- ✅ 低波动率筛选
- ✅ 动量过滤
- ✅ 综合评分
- ✅ 风险指标计算
- ✅ 组合统计

### 未来可扩展

- 🔄 加入基本面因子（如信用评级）
- 🔄 动态调整持仓权重
- 🔄 市场环境识别（牛熊切换）
- 🔄 更复杂的止损机制
- 🔄 机器学习优化参数

## 参考资料

- [Low Volatility Anomaly](https://en.wikipedia.org/wiki/Low-volatility_anomaly)
- 《量化投资策略与技术》
- 《债券投资实战》

## 常见问题

### Q: 为什么选择60日作为波动率窗口？

A: 60个交易日约等于3个月，既能反映中期趋势，又不会过于滞后。这是业界常用的参数。

### Q: 可以用于股票吗？

A: 可以，但需要调整参数。股票波动率更高，建议提高波动率阈值，增加止损力度。

### Q: 推荐数量设置为多少合适？

A: 5-10只。太少分散化不足，太多稀释了选择效果。债券建议10只左右。

### Q: 如何处理新上市的基金？

A: 确保至少有80个交易日的数据才纳入候选池，避免数据不足导致指标失真。

### Q: 策略什么时候会失效？

A: 在极端市场环境（如2020年3月暴跌）可能短期失效。建议结合市场环境判断，必要时降低仓位。
